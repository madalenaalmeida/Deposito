<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Painel de Administração</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.1/xlsx.full.min.js"></script>
  <link rel="stylesheet" href="admin-style.css">
</head>
<body>

<!-- Navbar -->
<nav class="navbar">
  <a href="index.html" class="voltar-inicio">
    <i class="fas fa-home"></i>
  </a>
  <span class="navbar-text">Área Administrativa</span>
</nav>

<br><br><br>

<div class="admin-container"> 
  <h1>Painel de Administração</h1>

  <h2>Pedidos por Ramo</h2>
  <table id="pedidosTabela">
    <thead>
      <tr>
        <th>Ramo</th>
        <th>Produto</th>
        <th>Tamanho</th>
        <th>Quantidade</th>
        <th>Observações</th>
        <th>Ações</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <h2>Pedidos Detalhados</h2>
  <table id="pedidosDetalhadosTabela">
    <thead>
      <tr>
        <th>Nome</th>
        <th>Email</th>
        <th>Produto</th>
        <th>Tamanho</th>
        <th>Quantidade</th>
        <th>Observações</th>
        <th>Ações</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <h2>Pedidos por Produto (Total)</h2>
  <div id="produtoResumoContainer"></div>
  <button onclick="exportarResumoProdutos()">Exportar Resumo de Produtos</button>

  <h2>Pedidos Agrupados por Ramo</h2>
  <div id="groupedOrdersContainer"></div>

  <div class="buttons-container">
    <button onclick="exportarParaExcel('pedidosTabela', 'pedidos_ramos')">Exportar Pedidos por Ramo</button>
    <button onclick="exportarParaExcel('pedidosDetalhadosTabela', 'pedidos_detalhados')">Exportar Pedidos Detalhados</button>
    <button onclick="exportarPedidosPorRamoParaExcel()">Exportar Pedidos por Ramo (Detalhados)</button>
    <button onclick="limparDados()">Limpar Dados</button>
  </div>
</div>

<section>
  <h2>Definir Períodos de Encomenda</h2>
  <div class="formulario-submissao">
    <form id="datesForm">
      <label for="start-date-input">Data de Início:</label>
      <input type="date" id="start-date-input" required>
      <label for="end-date-input">Data de Fim:</label>
      <input type="date" id="end-date-input" required>
      <button type="submit">Salvar Datas</button>
    </form>
  </div>
</section>

<script src="admin.js"></script>

<br>
<footer class="footer">
  <div class="footer-content">
    <p>&copy; 2025 Guias de Viseu - Depósito. Todos os direitos reservados.</p>
  </div>
</footer>
</body>
</html>
